<!DOCTYPE html>
<html lang="zh-Hant" data-theme="dark">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>æ±äº¬å…­æ—¥éŠï¼ˆ11æœˆãƒ»è‡ªç”±è¡Œï¼‰è©³ç›¡ç‰ˆ</title>
  <style>
    :root {
      color-scheme: dark light;
      --bg-dark: #0b0c10;
      --bg-light: #f9fafc;
      --text-dark: #e6edf3;
      --text-light: #1a1e2b;
      --muted-dark: #8892b0;
      --muted-light: #5c6478;
      --card-dark: #111317;
      --card-light: #ffffff;
      --border-dark: #1f2330;
      --border-light: #dbe2ee;
      --table-header-dark: #151925;
      --table-header-light: #eef2fb;
      --accent: #64ffda;
      --accent-strong: #4ea1ff;
      --shadow-dark: 0 14px 32px rgba(10, 15, 38, 0.35);
      --shadow-light: 0 14px 32px rgba(15, 23, 42, 0.16);
      --transition-speed: 0.3s;
      --page-bg: var(--bg-dark);
      --page-text: var(--text-dark);
      --muted-text: var(--muted-dark);
      --card-bg: var(--card-dark);
      --border-color: var(--border-dark);
      --table-header: var(--table-header-dark);
      --card-shadow: var(--shadow-dark);
    }

    :root[data-theme="light"] {
      --page-bg: var(--bg-light);
      --page-text: var(--text-light);
      --muted-text: var(--muted-light);
      --card-bg: var(--card-light);
      --border-color: var(--border-light);
      --table-header: var(--table-header-light);
      --card-shadow: var(--shadow-light);
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial, "Noto Sans TC", "PingFang TC", "Microsoft JhengHei", sans-serif;
      line-height: 1.65;
      background: var(--page-bg);
      color: var(--page-text);
      transition: background var(--transition-speed) ease, color var(--transition-speed) ease;
    }

    a {
      color: var(--accent-strong);
      text-decoration: none;
    }

    a:hover,
    a:focus {
      opacity: 0.9;
      text-decoration: underline;
    }

    .wrap {
      max-width: 1100px;
      margin: 0 auto;
      padding: 32px 24px 48px;
    }

    header {
      display: grid;
      gap: 16px;
      padding-bottom: 24px;
      margin-bottom: 32px;
      border-bottom: 1px solid var(--border-color);
    }

    .header-top {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      gap: 16px;
      align-items: center;
    }

    .header-actions {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 8px;
    }

    .exchange-rate {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      border-radius: 999px;
      border: 1px solid var(--border-color);
      background: var(--card-bg);
      color: var(--muted-text);
      font-size: 14px;
      box-shadow: var(--card-shadow);
      min-width: max-content;
    }

    .exchange-rate strong {
      color: var(--accent-strong);
      font-size: 15px;
    }

    .exchange-rate .rate-updated {
      font-size: 12px;
      color: var(--muted-text);
    }

    h1 {
      font-size: clamp(26px, 4vw, 40px);
      line-height: 1.2;
      margin: 0;
    }

    .meta {
      color: var(--muted-text);
      font-size: 14px;
    }

    .cta-group {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
    }

    .cta {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: var(--accent);
      color: #012622;
      padding: 10px 16px;
      border-radius: 12px;
      font-weight: 600;
      transition: transform var(--transition-speed) ease, box-shadow var(--transition-speed) ease;
      box-shadow: var(--card-shadow);
    }

    .cta:hover,
    .cta:focus {
      transform: translateY(-2px);
      box-shadow: 0 12px 24px rgba(100, 255, 218, 0.35);
    }

    .nav {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      font-size: 15px;
    }

    .nav a {
      padding: 6px 12px;
      border-radius: 999px;
      border: 1px solid transparent;
      transition: background var(--transition-speed) ease, border var(--transition-speed) ease;
      color: var(--page-text);
    }

    .nav a:hover,
    .nav a:focus {
      border-color: var(--border-color);
      background: var(--card-bg);
      text-decoration: none;
    }

    .card {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      padding: 18px 20px;
      margin: 16px 0;
      box-shadow: var(--card-shadow);
      transition: transform var(--transition-speed) ease, box-shadow var(--transition-speed) ease;
    }

    .card:hover {
      transform: translateY(-4px);
      box-shadow: 0 16px 30px rgba(76, 95, 255, 0.15);
    }

    h2 {
      margin: 48px 0 16px;
      font-size: clamp(22px, 3vw, 30px);
    }

    h3 {
      margin: 20px 0 8px;
      font-size: clamp(18px, 2.6vw, 24px);
    }

    .day {
      border-left: 3px solid var(--accent-strong);
      padding-left: 16px;
      margin: 28px 0;
    }

    .note {
      font-size: 14px;
      color: var(--muted-text);
      margin-top: 12px;
    }

    .note strong {
      color: var(--page-text);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin: 12px 0 24px;
      background: var(--card-bg);
      border-radius: 16px;
      overflow: hidden;
      box-shadow: var(--card-shadow);
      border: 1px solid var(--border-color);
    }

    th,
    td {
      border-bottom: 1px solid var(--border-color);
      padding: 14px 16px;
      vertical-align: top;
      text-align: left;
      transition: background var(--transition-speed) ease;
    }

    thead th {
      background: var(--table-header);
      color: var(--page-text);
      font-weight: 600;
      font-size: 15px;
    }

    tbody tr:hover td {
      background: rgba(78, 161, 255, 0.08);
    }

    .badge {
      display: inline-block;
      padding: 2px 10px;
      border-radius: 999px;
      background: rgba(100, 255, 218, 0.14);
      color: var(--accent);
      font-size: 12px;
      font-weight: 600;
      letter-spacing: 0.02em;
      text-transform: uppercase;
    }

    .theme-toggle {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      border-radius: 999px;
      border: 1px solid var(--border-color);
      background: var(--card-bg);
      color: var(--page-text);
      font-size: 14px;
      cursor: pointer;
      transition: background var(--transition-speed) ease, transform var(--transition-speed) ease;
    }

    .theme-toggle:hover,
    .theme-toggle:focus {
      transform: translateY(-2px);
      background: rgba(78, 161, 255, 0.12);
    }

    .section-intro {
      display: grid;
      gap: 12px;
      max-width: 760px;
      color: var(--muted-text);
      font-size: 15px;
    }

    .grid-2 {
      display: grid;
      gap: 18px;
    }

    @media (min-width: 768px) {
      header {
        grid-template-columns: 1fr;
      }

      .grid-2 {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    @media (max-width: 640px) {
      .wrap {
        padding: 24px 18px 40px;
      }

      .header-actions {
        align-items: flex-start;
      }

      table,
      th,
      td {
        font-size: 14px;
      }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="header-top">
        <h1>æ±äº¬å…­æ—¥éŠï¼ˆå‹•ç·šå„ªåŒ–ï¼‹ä¼‘é–’å¹³è¡¡ï¼‰â€” 11 æœˆãƒ»è‡ªç”±è¡Œã€Œè©³ç›¡ç‰ˆã€</h1>
        <div class="header-actions">
          <div id="exchangeRate" class="exchange-rate" aria-live="polite">åŒ¯ç‡è¼‰å…¥ä¸­â€¦</div>
          <button id="themeToggle" class="theme-toggle" type="button" aria-label="åˆ‡æ›é»‘ç™½èƒŒæ™¯">
            <span aria-hidden="true">ğŸŒ“</span>
            <span class="toggle-text">é»‘åº•</span>
          </button>
        </div>
      </div>
      <div class="meta">
        ä½å®¿ï¼šæŠ¼ä¸Š 3 æ™šï¼ˆRichmond Hotel Premier Tokyo Scholeï¼‰ï½œæ–°å®¿ 3 æ™šï¼ˆJRä¹å· Blossom Shinjukuï¼‰<br>
        æŠµé”ï¼šæˆç”°ï¼ˆç´„ 14:00ï¼‰ï½œé›¢å¢ƒï¼šæˆç”° 13:00 ç­æ©Ÿï½œç”¢ç”Ÿæ—¥æœŸï¼š2025-10-07
      </div>
      <div class="cta-group">
        <a class="cta" href="tokyo_itinerary_per_day.kml" download>ä¸‹è¼‰ KMLï¼ˆMy Maps åˆ†æ—¥ï¼‰</a>
        <a class="cta" href="tokyo_itinerary_places_enhanced.csv" download>ä¸‹è¼‰ CSVï¼ˆè‡ªè¨‚é¡è‰²ï¼‰</a>
        <a class="cta" href="tokyo_itinerary_places_with_address.csv" download>ä¸‹è¼‰ CSVï¼ˆå«åœ°å€ï¼Œå»ºè­°åŒ¯å…¥ï¼‰</a>
      </div>
      <nav class="nav" aria-label="é é¢å°è¦½">
        <a href="#tickets">äº¤é€šç¥¨åˆ¸</a>
        <a href="#schedule">æ—¥ç¨‹è¦åŠƒ</a>
        <a href="#food">é¤é£²åå–®</a>
        <a href="#tips">å‚™ç”¨æ–¹æ¡ˆ</a>
      </nav>
    </header>

    <section id="tickets">
      <h2>ğŸ« äº¤é€šç¥¨åˆ¸å»ºè­° <span class="badge">å¿…å‚™</span></h2>
      <div class="section-intro">
        <p>ä¾ç…§å‹•ç·šå®‰æ’å°‡å¤§çœ¾é‹è¼¸ç¥¨åˆ¸åˆ†é…åœ¨å‰ä¸‰å¤©ï¼Œæ­é… IC å¡å¯æœ‰æ•ˆç¯€çœäº¤é€šæ™‚é–“èˆ‡æˆæœ¬ã€‚è‹¥è¡Œç¨‹æƒ³å»¶ä¼¸è‡³éŒå€‰æˆ–æ²³å£æ¹–ï¼Œå¯è¦–éœ€æ±‚åŠ è³¼å€åŸŸæ€§å‘¨éŠåˆ¸ã€‚</p>
      </div>
      <table class="table">
        <thead>
          <tr><th>ç¥¨åˆ¸</th><th>ä½¿ç”¨æ—¥</th><th>èªªæ˜</th></tr>
        </thead>
        <tbody>
          <tr><td>Tokyo Subway 72 å°æ™‚ç¥¨</td><td>Day 1â€“3</td><td>Metroï¼‹éƒ½ç‡Ÿåœ°éµç„¡é™æ­ä¹˜ï¼Œå¸‚å€ç§»å‹•æœ€çœ</td></tr>
          <tr><td>Suica / Pasmo</td><td>å…¨ç¨‹</td><td>JR/åœ°éµ/å·´å£«/ä¾¿åˆ©å•†åº—çš†å¯ç”¨</td></tr>
          <tr><td>ï¼ˆé¸é…ï¼‰éŒå€‰ãƒ»æ±Ÿä¹‹å³¶å‘¨éŠåˆ¸</td><td>Day 3</td><td>æ–°å®¿â†”éŒå€‰ï¼‹æ±Ÿä¹‹é›»æ—…éŠç”¨</td></tr>
          <tr><td>æ²³å£æ¹–ï¼šé«˜é€Ÿå·´å£« / å¯Œå£«å›éŠè™Ÿ</td><td>Day 4</td><td>æ“‡ä¸€å¾€è¿”å³å¯ï¼Œè¦–ç­æ¬¡é¸æ“‡</td></tr>
        </tbody>
      </table>
    </section>

    <section id="schedule">
      <h2>ğŸ—“ è©³ç›¡æ—¥ç¨‹</h2>
      <div class="day">
        <h3>Day 1ï½œæŠµé” â†’ æŠ¼ä¸Šï¼ˆæ™´ç©ºå¡”ï¼‰</h3>
        <div class="card"><strong>æ™‚é–“å»ºè­°ï¼š</strong> æŠµé” 14:00 â†’ 15:30 å…¥ä½ â†’ 17:00â€“18:30 æ™´ç©ºå¡”å¤•é™½ï¼‹å¤œæ™¯ â†’ Solamachi æ™šé¤</div>
        <div class="card"><strong>äº¤é€šï¼š</strong> æˆç”° â†’ æŠ¼ä¸Šï¼ˆäº¬æˆ Access Express / Skylinerï¼‰ï½œIC å¡ Suica / Pasmo çš†å¯ç”¨</div>
        <div class="card"><strong>é¤é£²ï¼š</strong> å…­å˜èˆï¼ˆæ²¾éºµï¼‰ã€Hitsumabushi Nagoya Binchoï¼ˆé°»é­šé£¯ï¼‰ã€æ·ºè‰å‚³çµ±å°åƒ</div>
        <div class="note">å°æé†’ï¼šå…ˆåŠ å€¼ IC å¡ï¼›æ™´ç©ºå¡”ç¶²è·¯é ç´„å¯çœæ’éšŠã€‚</div>
      </div>

      <div class="day">
        <h3>Day 2ï½œä¸Šé‡ â†’ ç§‹è‘‰åŸ â†’ éŠ€åº§</h3>
        <div class="card"><strong>æ™‚é–“å»ºè­°ï¼š</strong> 09:00 ä¸Šé‡å…¬åœ’ï¼‹åšç‰©é¤¨ â†’ 12:00 é˜¿ç¾æ©«ç”ºåˆé¤ â†’ 14:00 ç§‹è‘‰åŸ â†’ 17:00 éŠ€åº§å¤œæ™¯</div>
        <div class="card"><strong>äº¤é€šï¼š</strong> æŠ¼ä¸Š â‡„ ä¸Šé‡ï¼ˆMetroï¼‰ï½œä¸Šé‡ â‡„ ç§‹è‘‰åŸï¼ˆJRï¼‰ï½œç§‹è‘‰åŸ â†’ éŠ€åº§ï¼ˆæ—¥æ¯”è°·ç·šç›´é”ï¼‰</div>
        <div class="card"><strong>é¤é£²ï¼š</strong> ä¸Šé‡é°»é­šï¼è±¬æ’ã€ç§‹è‘‰åŸç”œé»èˆ‡å’–å•¡ã€éŠ€åº§å£½å¸æˆ–å±…é…’å±‹</div>
        <div class="note">æ³¨æ„é–‹é¤¨æ—¥ï¼›éŠ€åº§ååº—å¸¸éœ€é ç´„ã€‚</div>
      </div>

      <div class="day">
        <h3>Day 3ï½œéŒå€‰ä¸€æ—¥ â†’ æ™šä¸Šå…¥ä½æ–°å®¿</h3>
        <div class="card"><strong>æ™‚é–“å»ºè­°ï¼š</strong> 08:00 æ–°å®¿å‡ºç™¼ â†’ 09:00 éŒå€‰ç«™ â†’ é¶´å²¡å…«å¹¡å®®ãƒ»å°ç”ºé€š â†’ é•·è°·å¯ºãƒ»å¤§ä½› â†’ï¼ˆé¸ï¼‰æ±Ÿä¹‹é›» â†’ 18:00 å›æ–°å®¿</div>
        <div class="card"><strong>äº¤é€šï¼š</strong> æ–°å®¿ â‡„ éŒå€‰ï¼ˆJR æ¹˜å—æ–°å®¿ç·šï¼‰ï½œéŒå€‰å€åŸŸç”¨æ±Ÿä¹‹é›»ç§»å‹•</div>
        <div class="card"><strong>é¤é£²ï¼š</strong> Bills ä¸ƒé‡Œæ¿±ï¼ˆæµ·æ™¯ï¼‰ã€éŒå€‰é‡œé£¯ï¼›æ™šé¤æ–°å®¿æ€å‡ºæ©«ä¸</div>
      </div>

      <div class="day">
        <h3>Day 4ï½œæ²³å£æ¹–ãƒ»å¯Œå£«å±±ä¸€æ—¥</h3>
        <div class="card">
          <strong>æ™‚é–“å»ºè­°ï¼š</strong>
          07:00 æ–°å®¿å‡ºç™¼ â†’ 09:00 æ²³å£æ¹–ç«™ â†’ çºœè»Š â†’ éŠèˆ¹ â†’ ã»ã†ã¨ã†ä¸å‹•åˆé¤ â†’ å¤§çŸ³å…¬åœ’ â†’ æ–°å€‰å¯Œå£«æ·ºé–“ç¥ç¤¾ â†’ 17:30 å›ç¨‹
        </div>
        <div class="card"><strong>äº¤é€šï¼š</strong> æ–°å®¿ Busta é«˜é€Ÿå·´å£«ï¼ˆç´„1h45ï¼‰æˆ– å¯Œå£«å›éŠè™Ÿï¼ˆç´„2h05ï¼‰ï½œç«™å‰å¯ç§Ÿé›»å‹•è…³è¸è»Šæˆ–æ­è§€å…‰å·´å£«</div>
        <div class="card"><strong>é¤é£²ï¼š</strong> ã»ã†ã¨ã†ä¸å‹•ã€è‡ªç„¶ç”Ÿæ´»é¤¨ç”œé»ï¼›å›ç¨‹æ–°å®¿é¢¨é›²å…æ‹‰éºµ</div>
        <div class="note">å¤©å€™å½±éŸ¿è¦–é‡å¤§ï¼›å±±å€æ—©æ™šæº«å·®æ³¨æ„ä¿æš–ã€‚</div>
      </div>

      <div class="day">
        <h3>Day 5ï½œè¡¨åƒé“ Ã— ä¸‹åŒ—æ¾¤</h3>
        <div class="card"><strong>æ™‚é–“å»ºè­°ï¼š</strong> è¡¨åƒé“å»ºç¯‰æ•£æ­¥ â†’ Blue Bottle / Koffee Mameya â†’ åˆé¤ Afuri æˆ– Maisen â†’ ä¸‹åŒ—æ¾¤å¤è‘—è¡— â†’ æ™šé–“æ–°å®¿</div>
        <div class="card"><strong>äº¤é€šï¼š</strong> è¡¨åƒé“ç«™ï¼ˆG/C/Z ç·šï¼‰â†’ ä»£ä»£æœ¨ä¸ŠåŸè½‰å°ç”°æ€¥ç·šè‡³ä¸‹åŒ—æ¾¤ï¼ˆç´„20 åˆ†ï¼‰</div>
        <div class="card"><strong>é¤é£²ï¼š</strong> å’–å•¡å…©å¼·ã€Afuri æŸšå­æ‹‰éºµã€Maisen è±¬æ’ã€Daruma/Anjin æ™šé¤</div>
      </div>

      <div class="day">
        <h3>Day 6ï½œå…­æœ¬æœ¨è—è¡“ â†’ æˆç”°é›¢å¢ƒ</h3>
        <div class="card"><strong>æ™‚é–“å»ºè­°ï¼š</strong> ä¸Šåˆæ£®ç¾è¡“é¤¨ï¼†City View â†’ æ¯›åˆ©åº­åœ’ â†’ ä¸­åˆè¿”æ–°å®¿å–è¡Œæ â†’ 09:30 å‰å»ºè­°å‡ºç™¼å¾€æˆç”°</div>
        <div class="card"><strong>äº¤é€šï¼š</strong> æ–°å®¿ â‡„ å…­æœ¬æœ¨ï¼ˆå¤§æ±Ÿæˆ¶ç·šï¼‰ï½œæˆç”°ï¼šNEX / Skyliner / å·´å£«ï¼ˆè¦–ç­æ¬¡ï¼‰</div>
        <div class="card"><strong>é¤é£²ï¼š</strong> å…­æœ¬æœ¨æ—©åˆé¤ï¼ˆEggcellent / TUSK CafÃ©ï¼‰ï¼›è‹¥å»¶å¾Œè¿”ç¨‹å¯å»æ±äº¬éµå¡”é¤å»³è¡—</div>
      </div>
    </section>

    <section id="food">
      <h2>ğŸ± é¤é£²å£è¢‹åå–®</h2>
      <div class="section-intro">
        <p>ç²¾é¸å„å€åœ¨åœ°ååº—èˆ‡ç‰¹è‰²å’–å•¡ï¼Œä¾é€ è¨ªæ—¥æ­é…é™„è¿‘è¡Œç¨‹å³å¯ã€‚å°–å³°æ™‚æ®µå»ºè­°ææ—©å€™ä½æˆ–é ç´„ï¼Œä»¥å…éŒ¯éå–œæ„›é¤å»³ã€‚</p>
      </div>
      <table class="table">
        <thead><tr><th>å€åŸŸ</th><th>é¤å»³</th><th>æ¨è–¦</th></tr></thead>
        <tbody>
          <tr><td>æŠ¼ä¸Š / æ·ºè‰</td><td>å…­å˜èˆã€æ·ºè‰ä»ŠåŠã€å¤§é»‘å®¶å¤©ä¸¼</td><td>æ²¾éºµ / å£½å–œç‡’ / å¤©ä¸¼</td></tr>
          <tr><td>ä¸Šé‡ / ç§‹è‘‰åŸ</td><td>ç‡•æ¨‚è±¬æ’ã€Mandarake æ—å’–å•¡</td><td>è±¬æ’ / ç”œé»</td></tr>
          <tr><td>éŠ€åº§</td><td>å£½å¸ä¸‰æ˜§ã€é³¥è²´æ—</td><td>å£½å¸ / å±…é…’å±‹</td></tr>
          <tr><td>éŒå€‰</td><td>Bills ä¸ƒé‡Œæ¿±ã€é‡œé£¯ å¿—æ‘©</td><td>æµ·æ™¯æ—©åˆé¤ / åœ¨åœ°å®šé£Ÿ</td></tr>
          <tr><td>æ²³å£æ¹–</td><td>ã»ã†ã¨ã†ä¸å‹•ã€è‡ªç„¶ç”Ÿæ´»é¤¨</td><td>å‘³å™Œé‹éºµ / è—è“ç”œå“</td></tr>
          <tr><td>è¡¨åƒé“ / ä¸‹åŒ—æ¾¤</td><td>Afuriã€Maisenã€Blue Bottleã€Koffee Mameya</td><td>æ‹‰éºµ / è±¬æ’ / å’–å•¡</td></tr>
          <tr><td>å…­æœ¬æœ¨</td><td>Eggcellentã€TUSK CafÃ©</td><td>æ—©åˆé¤ / è¼•é£Ÿ</td></tr>
        </tbody>
      </table>
    </section>

    <section id="tips">
      <h2>ğŸŒ§ å‚™ç”¨æ–¹æ¡ˆ</h2>
      <div class="card">
        <strong>é›¨å¤©æ›¿ä»£ï¼š</strong> ä¸Šé‡æˆ–å…­æœ¬æœ¨ç¾è¡“é¤¨å·¡ç¦®ã€å°å ´è³¼ç‰©ä¸­å¿ƒã€æ™´ç©ºå¡”å•†å ´èˆ‡æ°´æ—é¤¨ã€‚
        <p class="note"><strong>å»ºè­°ï¼š</strong> äº‹å…ˆå‚™å¦¥äº¤é€šç¥¨åˆ¸èˆ‡é¤å»³å‚™é¸æ¸…å–®ï¼Œæ ¹æ“šå¤©å€™éˆæ´»èª¿æ•´ã€‚</p>
      </div>
    </section>
  </div>

  <script>
    (function () {
      const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
      const storedTheme = localStorage.getItem('tokyo-trip-theme');
      const initialTheme = storedTheme || (prefersDark ? 'dark' : 'light');
      const root = document.documentElement;
      const toggleBtn = document.getElementById('themeToggle');
      const toggleText = toggleBtn.querySelector('.toggle-text');

      function applyTheme(theme) {
        const isDark = theme === 'dark';
        root.dataset.theme = theme;
        toggleText.textContent = isDark ? 'é»‘åº•' : 'ç™½åº•';
        toggleBtn.setAttribute('aria-pressed', String(isDark));
      }

      applyTheme(initialTheme);

      toggleBtn.addEventListener('click', () => {
        const newTheme = root.dataset.theme === 'dark' ? 'light' : 'dark';
        localStorage.setItem('tokyo-trip-theme', newTheme);
        applyTheme(newTheme);
      });
    })();

    (function () {
      const rateEl = document.getElementById('exchangeRate');
      if (!rateEl) return;

      const RATE_ENDPOINT = 'https://api.exchangerate.host/latest?base=TWD&symbols=JPY';
      const numberFormatter = new Intl.NumberFormat('zh-Hant', {
        minimumFractionDigits: 2,
        maximumFractionDigits: 2
      });
      const timeFormatter = new Intl.DateTimeFormat('zh-Hant', {
        hour: '2-digit',
        minute: '2-digit',
        hour12: false,
        timeZone: 'Asia/Taipei'
      });

      async function updateRate() {
        try {
          const response = await fetch(RATE_ENDPOINT);
          if (!response.ok) {
            throw new Error(`Network response was not ok (${response.status})`);
          }
          const data = await response.json();
          const rate = data && data.rates && data.rates.JPY;

          if (typeof rate === 'number') {
            const formattedRate = numberFormatter.format(rate);
            const now = new Date();
            const formattedTime = timeFormatter.format(now);
            rateEl.innerHTML = `<span>1 TWD â‰ˆ <strong>${formattedRate}</strong> JPY</span><span class="rate-updated">æ›´æ–° ${formattedTime}</span>`;
            rateEl.setAttribute('title', `æ›´æ–°æ™‚é–“ï¼ˆå°åŒ—ï¼‰ï¼š${formattedTime}`);
            return;
          }

          throw new Error('Invalid rate data received');
        } catch (error) {
          console.error('Failed to fetch exchange rate', error);
          rateEl.textContent = 'åŒ¯ç‡æš«æ™‚ç„¡æ³•å–å¾—';
          rateEl.removeAttribute('title');
        }
      }

      updateRate();
      setInterval(updateRate, 30 * 60 * 1000);
    })();
  </script>
</body>
</html>
