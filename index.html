<!DOCTYPE html>
<html lang="zh-Hant" data-theme="dark">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>東京六日遊（11月・自由行）詳盡版</title>
  <style>
    :root {
      color-scheme: dark light;
      --bg-dark: #0b0c10;
      --bg-light: #f9fafc;
      --text-dark: #e6edf3;
      --text-light: #1a1e2b;
      --muted-dark: #8892b0;
      --muted-light: #5c6478;
      --card-dark: #111317;
      --card-light: #ffffff;
      --border-dark: #1f2330;
      --border-light: #dbe2ee;
      --table-header-dark: #151925;
      --table-header-light: #eef2fb;
      --accent: #64ffda;
      --accent-strong: #4ea1ff;
      --shadow-dark: 0 14px 32px rgba(10, 15, 38, 0.35);
      --shadow-light: 0 14px 32px rgba(15, 23, 42, 0.16);
      --transition-speed: 0.3s;
      --page-bg: var(--bg-dark);
      --page-text: var(--text-dark);
      --muted-text: var(--muted-dark);
      --card-bg: var(--card-dark);
      --border-color: var(--border-dark);
      --table-header: var(--table-header-dark);
      --card-shadow: var(--shadow-dark);
    }

    :root[data-theme="light"] {
      --page-bg: var(--bg-light);
      --page-text: var(--text-light);
      --muted-text: var(--muted-light);
      --card-bg: var(--card-light);
      --border-color: var(--border-light);
      --table-header: var(--table-header-light);
      --card-shadow: var(--shadow-light);
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial, "Noto Sans TC", "PingFang TC", "Microsoft JhengHei", sans-serif;
      line-height: 1.65;
      background: var(--page-bg);
      color: var(--page-text);
      transition: background var(--transition-speed) ease, color var(--transition-speed) ease;
    }

    a {
      color: var(--accent-strong);
      text-decoration: none;
    }

    a:hover,
    a:focus {
      opacity: 0.9;
      text-decoration: underline;
    }

    .wrap {
      max-width: 1100px;
      margin: 0 auto;
      padding: 32px 24px 48px;
    }

    header {
      display: grid;
      gap: 16px;
      padding-bottom: 24px;
      margin-bottom: 32px;
      border-bottom: 1px solid var(--border-color);
    }

    .header-top {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      gap: 16px;
      align-items: center;
    }

    .header-actions {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 8px;
    }

    .exchange-rate {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      border-radius: 999px;
      border: 1px solid var(--border-color);
      background: var(--card-bg);
      color: var(--muted-text);
      font-size: 14px;
      box-shadow: var(--card-shadow);
      min-width: max-content;
    }

    .exchange-rate strong {
      color: var(--accent-strong);
      font-size: 15px;
    }

    .exchange-rate .rate-updated {
      font-size: 12px;
      color: var(--muted-text);
    }

    h1 {
      font-size: clamp(26px, 4vw, 40px);
      line-height: 1.2;
      margin: 0;
    }

    .meta {
      color: var(--muted-text);
      font-size: 14px;
    }

    .cta-group {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
    }

    .cta {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: var(--accent);
      color: #012622;
      padding: 10px 16px;
      border-radius: 12px;
      font-weight: 600;
      transition: transform var(--transition-speed) ease, box-shadow var(--transition-speed) ease;
      box-shadow: var(--card-shadow);
    }

    .cta:hover,
    .cta:focus {
      transform: translateY(-2px);
      box-shadow: 0 12px 24px rgba(100, 255, 218, 0.35);
    }

    .nav {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      font-size: 15px;
    }

    .nav a {
      padding: 6px 12px;
      border-radius: 999px;
      border: 1px solid transparent;
      transition: background var(--transition-speed) ease, border var(--transition-speed) ease;
      color: var(--page-text);
    }

    .nav a:hover,
    .nav a:focus {
      border-color: var(--border-color);
      background: var(--card-bg);
      text-decoration: none;
    }

    .card {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      padding: 18px 20px;
      margin: 16px 0;
      box-shadow: var(--card-shadow);
      transition: transform var(--transition-speed) ease, box-shadow var(--transition-speed) ease;
    }

    .card:hover {
      transform: translateY(-4px);
      box-shadow: 0 16px 30px rgba(76, 95, 255, 0.15);
    }

    h2 {
      margin: 48px 0 16px;
      font-size: clamp(22px, 3vw, 30px);
    }

    h3 {
      margin: 20px 0 8px;
      font-size: clamp(18px, 2.6vw, 24px);
    }

    .day {
      border-left: 3px solid var(--accent-strong);
      padding-left: 16px;
      margin: 28px 0;
    }

    .note {
      font-size: 14px;
      color: var(--muted-text);
      margin-top: 12px;
    }

    .note strong {
      color: var(--page-text);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin: 12px 0 24px;
      background: var(--card-bg);
      border-radius: 16px;
      overflow: hidden;
      box-shadow: var(--card-shadow);
      border: 1px solid var(--border-color);
    }

    th,
    td {
      border-bottom: 1px solid var(--border-color);
      padding: 14px 16px;
      vertical-align: top;
      text-align: left;
      transition: background var(--transition-speed) ease;
    }

    thead th {
      background: var(--table-header);
      color: var(--page-text);
      font-weight: 600;
      font-size: 15px;
    }

    tbody tr:hover td {
      background: rgba(78, 161, 255, 0.08);
    }

    .badge {
      display: inline-block;
      padding: 2px 10px;
      border-radius: 999px;
      background: rgba(100, 255, 218, 0.14);
      color: var(--accent);
      font-size: 12px;
      font-weight: 600;
      letter-spacing: 0.02em;
      text-transform: uppercase;
    }

    .theme-toggle {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      border-radius: 999px;
      border: 1px solid var(--border-color);
      background: var(--card-bg);
      color: var(--page-text);
      font-size: 14px;
      cursor: pointer;
      transition: background var(--transition-speed) ease, transform var(--transition-speed) ease;
    }

    .theme-toggle:hover,
    .theme-toggle:focus {
      transform: translateY(-2px);
      background: rgba(78, 161, 255, 0.12);
    }

    .section-intro {
      display: grid;
      gap: 12px;
      max-width: 760px;
      color: var(--muted-text);
      font-size: 15px;
    }

    .grid-2 {
      display: grid;
      gap: 18px;
    }

    @media (min-width: 768px) {
      header {
        grid-template-columns: 1fr;
      }

      .grid-2 {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    @media (max-width: 640px) {
      .wrap {
        padding: 24px 18px 40px;
      }

      .header-actions {
        align-items: flex-start;
      }

      table,
      th,
      td {
        font-size: 14px;
      }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="header-top">
        <h1>東京六日遊（動線優化＋休閒平衡）— 11 月・自由行「詳盡版」</h1>
        <div class="header-actions">
          <div id="exchangeRate" class="exchange-rate" aria-live="polite">匯率載入中…</div>
          <button id="themeToggle" class="theme-toggle" type="button" aria-label="切換黑白背景">
            <span aria-hidden="true">🌓</span>
            <span class="toggle-text">黑底</span>
          </button>
        </div>
      </div>
      <div class="meta">
        住宿：押上 3 晚（Richmond Hotel Premier Tokyo Schole）｜新宿 3 晚（JR九州 Blossom Shinjuku）<br>
        抵達：成田（約 14:00）｜離境：成田 13:00 班機｜產生日期：2025-10-07
      </div>
      <div class="cta-group">
        <a class="cta" href="tokyo_itinerary_per_day.kml" download>下載 KML（My Maps 分日）</a>
        <a class="cta" href="tokyo_itinerary_places_enhanced.csv" download>下載 CSV（自訂顏色）</a>
        <a class="cta" href="tokyo_itinerary_places_with_address.csv" download>下載 CSV（含地址，建議匯入）</a>
      </div>
      <nav class="nav" aria-label="頁面導覽">
        <a href="#tickets">交通票券</a>
        <a href="#schedule">日程規劃</a>
        <a href="#food">餐飲名單</a>
        <a href="#tips">備用方案</a>
      </nav>
    </header>

    <section id="tickets">
      <h2>🎫 交通票券建議 <span class="badge">必備</span></h2>
      <div class="section-intro">
        <p>依照動線安排將大眾運輸票券分配在前三天，搭配 IC 卡可有效節省交通時間與成本。若行程想延伸至鎌倉或河口湖，可視需求加購區域性周遊券。</p>
      </div>
      <table class="table">
        <thead>
          <tr><th>票券</th><th>使用日</th><th>說明</th></tr>
        </thead>
        <tbody>
          <tr><td>Tokyo Subway 72 小時票</td><td>Day 1–3</td><td>Metro＋都營地鐵無限搭乘，市區移動最省</td></tr>
          <tr><td>Suica / Pasmo</td><td>全程</td><td>JR/地鐵/巴士/便利商店皆可用</td></tr>
          <tr><td>（選配）鎌倉・江之島周遊券</td><td>Day 3</td><td>新宿↔鎌倉＋江之電旅遊用</td></tr>
          <tr><td>河口湖：高速巴士 / 富士回遊號</td><td>Day 4</td><td>擇一往返即可，視班次選擇</td></tr>
        </tbody>
      </table>
    </section>

    <section id="schedule">
      <h2>🗓 詳盡日程</h2>
      <div class="day">
        <h3>Day 1｜抵達 → 押上（晴空塔）</h3>
        <div class="card"><strong>時間建議：</strong> 抵達 14:00 → 15:30 入住 → 17:00–18:30 晴空塔夕陽＋夜景 → Solamachi 晚餐</div>
        <div class="card"><strong>交通：</strong> 成田 → 押上（京成 Access Express / Skyliner）｜IC 卡 Suica / Pasmo 皆可用</div>
        <div class="card"><strong>餐飲：</strong> 六厘舍（沾麵）、Hitsumabushi Nagoya Bincho（鰻魚飯）、淺草傳統小吃</div>
        <div class="note">小提醒：先加值 IC 卡；晴空塔網路預約可省排隊。</div>
      </div>

      <div class="day">
        <h3>Day 2｜上野 → 秋葉原 → 銀座</h3>
        <div class="card"><strong>時間建議：</strong> 09:00 上野公園＋博物館 → 12:00 阿美橫町午餐 → 14:00 秋葉原 → 17:00 銀座夜景</div>
        <div class="card"><strong>交通：</strong> 押上 ⇄ 上野（Metro）｜上野 ⇄ 秋葉原（JR）｜秋葉原 → 銀座（日比谷線直達）</div>
        <div class="card"><strong>餐飲：</strong> 上野鰻魚／豬排、秋葉原甜點與咖啡、銀座壽司或居酒屋</div>
        <div class="note">注意開館日；銀座名店常需預約。</div>
      </div>

      <div class="day">
        <h3>Day 3｜鎌倉一日 → 晚上入住新宿</h3>
        <div class="card"><strong>時間建議：</strong> 08:00 新宿出發 → 09:00 鎌倉站 → 鶴岡八幡宮・小町通 → 長谷寺・大佛 →（選）江之電 → 18:00 回新宿</div>
        <div class="card"><strong>交通：</strong> 新宿 ⇄ 鎌倉（JR 湘南新宿線）｜鎌倉區域用江之電移動</div>
        <div class="card"><strong>餐飲：</strong> Bills 七里濱（海景）、鎌倉釜飯；晚餐新宿思出橫丁</div>
      </div>

      <div class="day">
        <h3>Day 4｜河口湖・富士山一日</h3>
        <div class="card">
          <strong>時間建議：</strong>
          07:00 新宿出發 → 09:00 河口湖站 → 纜車 → 遊船 → ほうとう不動午餐 → 大石公園 → 新倉富士淺間神社 → 17:30 回程
        </div>
        <div class="card"><strong>交通：</strong> 新宿 Busta 高速巴士（約1h45）或 富士回遊號（約2h05）｜站前可租電動腳踏車或搭觀光巴士</div>
        <div class="card"><strong>餐飲：</strong> ほうとう不動、自然生活館甜點；回程新宿風雲児拉麵</div>
        <div class="note">天候影響視野大；山區早晚溫差注意保暖。</div>
      </div>

      <div class="day">
        <h3>Day 5｜表參道 × 下北澤</h3>
        <div class="card"><strong>時間建議：</strong> 表參道建築散步 → Blue Bottle / Koffee Mameya → 午餐 Afuri 或 Maisen → 下北澤古著街 → 晚間新宿</div>
        <div class="card"><strong>交通：</strong> 表參道站（G/C/Z 線）→ 代代木上原轉小田急線至下北澤（約20 分）</div>
        <div class="card"><strong>餐飲：</strong> 咖啡兩強、Afuri 柚子拉麵、Maisen 豬排、Daruma/Anjin 晚餐</div>
      </div>

      <div class="day">
        <h3>Day 6｜六本木藝術 → 成田離境</h3>
        <div class="card"><strong>時間建議：</strong> 上午森美術館＆City View → 毛利庭園 → 中午返新宿取行李 → 09:30 前建議出發往成田</div>
        <div class="card"><strong>交通：</strong> 新宿 ⇄ 六本木（大江戶線）｜成田：NEX / Skyliner / 巴士（視班次）</div>
        <div class="card"><strong>餐飲：</strong> 六本木早午餐（Eggcellent / TUSK Café）；若延後返程可去東京鐵塔餐廳街</div>
      </div>
    </section>

    <section id="food">
      <h2>🍱 餐飲口袋名單</h2>
      <div class="section-intro">
        <p>精選各區在地名店與特色咖啡，依造訪日搭配附近行程即可。尖峰時段建議提早候位或預約，以免錯過喜愛餐廳。</p>
      </div>
      <table class="table">
        <thead><tr><th>區域</th><th>餐廳</th><th>推薦</th></tr></thead>
        <tbody>
          <tr><td>押上 / 淺草</td><td>六厘舍、淺草今半、大黑家天丼</td><td>沾麵 / 壽喜燒 / 天丼</td></tr>
          <tr><td>上野 / 秋葉原</td><td>燕樂豬排、Mandarake 旁咖啡</td><td>豬排 / 甜點</td></tr>
          <tr><td>銀座</td><td>壽司三昧、鳥貴族</td><td>壽司 / 居酒屋</td></tr>
          <tr><td>鎌倉</td><td>Bills 七里濱、釜飯 志摩</td><td>海景早午餐 / 在地定食</td></tr>
          <tr><td>河口湖</td><td>ほうとう不動、自然生活館</td><td>味噌鍋麵 / 藍莓甜品</td></tr>
          <tr><td>表參道 / 下北澤</td><td>Afuri、Maisen、Blue Bottle、Koffee Mameya</td><td>拉麵 / 豬排 / 咖啡</td></tr>
          <tr><td>六本木</td><td>Eggcellent、TUSK Café</td><td>早午餐 / 輕食</td></tr>
        </tbody>
      </table>
    </section>

    <section id="tips">
      <h2>🌧 備用方案</h2>
      <div class="card">
        <strong>雨天替代：</strong> 上野或六本木美術館巡禮、台場購物中心、晴空塔商場與水族館。
        <p class="note"><strong>建議：</strong> 事先備妥交通票券與餐廳備選清單，根據天候靈活調整。</p>
      </div>
    </section>
  </div>

  <script>
    (function () {
      const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
      const storedTheme = localStorage.getItem('tokyo-trip-theme');
      const initialTheme = storedTheme || (prefersDark ? 'dark' : 'light');
      const root = document.documentElement;
      const toggleBtn = document.getElementById('themeToggle');
      const toggleText = toggleBtn.querySelector('.toggle-text');

      function applyTheme(theme) {
        const isDark = theme === 'dark';
        root.dataset.theme = theme;
        toggleText.textContent = isDark ? '黑底' : '白底';
        toggleBtn.setAttribute('aria-pressed', String(isDark));
      }

      applyTheme(initialTheme);

      toggleBtn.addEventListener('click', () => {
        const newTheme = root.dataset.theme === 'dark' ? 'light' : 'dark';
        localStorage.setItem('tokyo-trip-theme', newTheme);
        applyTheme(newTheme);
      });
    })();

    (function () {
      const rateEl = document.getElementById('exchangeRate');
      if (!rateEl) return;

      const RATE_ENDPOINT = 'https://api.exchangerate.host/latest?base=TWD&symbols=JPY';
      const numberFormatter = new Intl.NumberFormat('zh-Hant', {
        minimumFractionDigits: 2,
        maximumFractionDigits: 2
      });
      const timeFormatter = new Intl.DateTimeFormat('zh-Hant', {
        hour: '2-digit',
        minute: '2-digit',
        hour12: false,
        timeZone: 'Asia/Taipei'
      });

      async function updateRate() {
        try {
          const response = await fetch(RATE_ENDPOINT);
          if (!response.ok) {
            throw new Error(`Network response was not ok (${response.status})`);
          }
          const data = await response.json();
          const rate = data && data.rates && data.rates.JPY;

          if (typeof rate === 'number') {
            const formattedRate = numberFormatter.format(rate);
            const now = new Date();
            const formattedTime = timeFormatter.format(now);
            rateEl.innerHTML = `<span>1 TWD ≈ <strong>${formattedRate}</strong> JPY</span><span class="rate-updated">更新 ${formattedTime}</span>`;
            rateEl.setAttribute('title', `更新時間（台北）：${formattedTime}`);
            return;
          }

          throw new Error('Invalid rate data received');
        } catch (error) {
          console.error('Failed to fetch exchange rate', error);
          rateEl.textContent = '匯率暫時無法取得';
          rateEl.removeAttribute('title');
        }
      }

      updateRate();
      setInterval(updateRate, 30 * 60 * 1000);
    })();
  </script>
</body>
</html>
